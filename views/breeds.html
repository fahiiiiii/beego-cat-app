<!-- views/breeds.html -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breeds</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        #Capa_1:hover,
        button:hover {

            color: rgb(255 104 65);
        }
    </style>
</head>

<body class="bg-gray-50">
    <nav class="mx-auto flex items-center justify-around bg-white shadow-md py-4">

        <div class="relative">
            <button type="button"
                class="flex flex-col items-center w-full text-sm font-semibold gap-y-2 group hover:text-primary transition-colors duration-200 ease-in-out"
                onclick="location.href='voting.html';">
                <button type="button"
                    class="flex flex-col items-center w-full text-sm font-semibold gap-y-2 group  hover:text-primary transition-colors duration-200 ease-in-out"
                    onclick="location.href='voting.html';"><svg class="w-6 h-6 hover:stroke-primary hover:fill-primary"
                        fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px"
                        viewBox="0 0 377.03 377.031" xml:space="preserve">
                        <g>
                            <g>
                                <path
                                    d="M58.876,315.796h48.549c13.426,0,24.355-10.93,24.355-24.355V184.819c0-0.918,0.335-1.74,0.985-2.391
                    c0.631-0.611,1.463-0.956,2.4-0.956l13.961,0.115c7.287,0.096,11.628-2.668,14-5.002c2.869-2.858,4.437-6.665,4.437-10.738
                    c0-4.035-1.472-8.052-4.389-11.934l-62.701-83.806c-4.16-5.604-10.241-8.836-16.687-8.836c-6.436,0-12.527,3.194-16.706,8.779
                    l-62.682,83.48C1.482,157.414,0,161.449,0,165.503c0,7.86,6.292,15.835,18.322,15.835H31.04c1.913,0,3.471,1.568,3.471,3.472
                    v106.621C34.521,304.876,45.451,315.796,58.876,315.796z M28.171,160.483c-1.587,0-0.306-3.423,2.859-7.65l47-62.605
                    c3.174-4.227,8.3-4.217,11.465,0.009l46.952,62.778c3.165,4.227,4.198,7.641,2.324,7.631l-3.404-0.028
                    c-6.531-0.077-12.651,2.41-17.279,6.99c-4.638,4.58-7.191,10.7-7.191,17.222v106.622c0,1.922-1.559,3.471-3.471,3.471H58.876
                    c-1.913,0-3.481-1.549-3.481-3.471V184.819c0-13.406-10.93-24.336-24.346-24.336C31.049,160.483,29.758,160.483,28.171,160.483z">
                                </path>
                                <path
                                    d="M318.154,61.234h-48.549c-13.426,0-24.347,10.93-24.347,24.355V192.21c0,0.92-0.344,1.742-0.994,2.391
                    c-0.631,0.613-1.463,0.957-2.4,0.957l-13.961-0.115c-7.287-0.096-11.628,2.668-14,5.002c-2.868,2.859-4.437,6.664-4.437,10.738
                    c0,4.035,1.473,8.053,4.389,11.953l62.701,83.787c4.16,5.604,10.242,8.836,16.687,8.836c6.437,0,12.527-3.193,16.706-8.779
                    l62.673-83.48c2.926-3.883,4.408-7.918,4.408-11.973c0-7.859-6.292-15.834-18.321-15.834H345.99c-1.912,0-3.471-1.568-3.471-3.473
                    V85.599C342.51,72.164,331.58,61.234,318.154,61.234z M348.859,216.548c1.587,0,0.306,3.424-2.869,7.65L299,286.804
                    c-3.175,4.227-8.31,4.217-11.465-0.01l-46.952-62.77c-3.165-4.227-4.208-7.639-2.324-7.631l3.404,0.029
                    c6.531,0.076,12.651-2.41,17.28-6.98c4.638-4.58,7.19-10.701,7.19-17.223V85.599c0-1.922,1.559-3.471,3.472-3.471h48.549
                    c1.922,0,3.48,1.549,3.48,3.471V192.22c0,13.408,10.93,24.338,24.346,24.338C345.98,216.548,347.271,216.548,348.859,216.548z">
                                </path>
                            </g>
                        </g>
                    </svg>
                    Voting
                </button>
        </div>

        <div class="relative">
            <button type="button"
                class="flex flex-col items-center w-full text-sm font-semibold gap-y-2 group text-primary hover:text-primary transition-colors duration-200 ease-in-out"
                onclick="location.href='breeds.html';">
                <svg class="w-6 h-6 hover:stroke-primary hover:fill-primary" version="1.0" id="Layer_1"
                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 64 64"
                    enable-background="new 0 0 64 64" xml:space="preserve" stroke="currentColor">
                    <g>
                        <path fill="#231F20"
                            d="M62.242,53.757L51.578,43.093C54.373,38.736,56,33.56,56,28C56,12.536,43.464,0,28,0S0,12.536,0,28
                                        s12.536,28,28,28c5.56,0,10.736-1.627,15.093-4.422l10.664,10.664c2.344,2.344,6.142,2.344,8.485,0S64.586,56.101,62.242,53.757z
                                        M28,54C13.641,54,2,42.359,2,28S13.641,2,28,2s26,11.641,26,26S42.359,54,28,54z M60.828,60.828c-1.562,1.562-4.095,1.562-5.656,0
                                        L44.769,50.425c2.145-1.606,4.051-3.513,5.657-5.656l10.402,10.402C62.391,56.732,62.391,59.266,60.828,60.828z">
                        </path>
                    </g>
                </svg>
                Breeds
            </button>
        </div>
        <div class="relative">
            <button type="button"
                class="flex flex-col items-center w-full text-sm font-semibold gap-y-2 group hover:text-primary transition-colors duration-200 ease-in-out"
                onclick="location.href='favorites.html';">
                <svg class="w-6 h-6 hover:stroke-primary hover:fill-primary" version="1.0" id="Layer_1"
                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 64 64"
                    enable-background="new 0 0 64 64" xml:space="preserve" stroke="currentColor">
                    <g>
                        <path fill="#231F20"
                            d="M48,6c-4.418,0-8.418,1.791-11.313,4.687l-3.979,3.961c-0.391,0.391-1.023,0.391-1.414,0
                                        c0,0-3.971-3.97-3.979-3.961C24.418,7.791,20.418,6,16,6C7.163,6,0,13.163,0,22c0,3.338,1.024,6.436,2.773,9
                                        c0,0,0.734,1.164,1.602,2.031s24.797,24.797,24.797,24.797C29.953,58.609,30.977,59,32,59s2.047-0.391,2.828-1.172
                                        c0,0,23.93-23.93,24.797-24.797S61.227,31,61.227,31C62.976,28.436,64,25.338,64,22C64,13.163,56.837,6,48,6z M58.714,30.977
                                        c0,0-0.612,0.75-1.823,1.961S33.414,56.414,33.414,56.414C33.023,56.805,32.512,57,32,57s-1.023-0.195-1.414-0.586
                                        c0,0-22.266-22.266-23.477-23.477s-1.823-1.961-1.823-1.961C3.245,28.545,2,25.424,2,22C2,14.268,8.268,8,16,8
                                        c3.866,0,7.366,1.566,9.899,4.101l0.009-0.009l4.678,4.677c0.781,0.781,2.047,0.781,2.828,0l4.678-4.677l0.009,0.009
                                        C40.634,9.566,44.134,8,48,8c7.732,0,14,6.268,14,14C62,25.424,60.755,28.545,58.714,30.977z">
                        </path>
                    </g>
                </svg>
                Favorites
            </button>
        </div>
    </nav>

    <section class="container mx-auto py-8">
        <h1 class="text-2xl font-bold text-gray-800 mb-6">Breeds</h1>
        <div class="mb-4">
            <select id="breed-select" class="w-full p-2 border border-gray-300 rounded-md"
                onchange="displayBreedDetails()">
                <option value="">Please select</option>
            </select>
        </div>
        <div id="breed-details" class="bg-white shadow-md p-4 rounded-lg hidden">
            <img id="breed-image" src="" alt="Breed Image" class="w-1/3 rounded-md mr-4">
            <div>
                <h2 id="breed-name" class="text-xl font-bold mb-2"></h2>
                <p id="breed-description" class="text-gray-700 mb-4"></p>
                <a id="breed-link" href="#" target="_blank" class="text-blue-500 hover:underline">Wikipedia</a>
            </div>
        </div>
    </section>


    
    <script>
        let breeds = [];
        let imageInterval; // To store the interval ID for cycling images
        let breedImages = []; // To store multiple images of the selected breed
        let currentImageIndex = 0; // To track the current image index

        // Fetch all breeds and populate the dropdown
        async function fetchBreeds() {
            try {
                const response = await fetch('https://api.thecatapi.com/v1/breeds');
                breeds = await response.json();

                const breedSelect = document.getElementById('breed-select');
                breeds.forEach(breed => {
                    const option = document.createElement('option');
                    option.value = breed.id;
                    option.textContent = breed.name;
                    breedSelect.appendChild(option);
                });

                // Restore previously selected breed
                const savedBreedId = localStorage.getItem('selectedBreed');
                if (savedBreedId) {
                    breedSelect.value = savedBreedId;
                    displayBreedDetails();
                }
            } catch (error) {
                console.error("Error fetching breeds:", error);
            }
        }

        // Fetch multiple images for a breed
        async function fetchBreedImages(breedId) {
            try {
                const response = await fetch(`https://api.thecatapi.com/v1/images/search?breed_ids=${breedId}&limit=5`);
                const data = await response.json();
                return data.map(item => item.url);
            } catch (error) {
                console.error("Error fetching breed images:", error);
                return ['https://via.placeholder.com/150']; // Fallback image
            }
        }

        // Display the details of the selected breed
        async function displayBreedDetails() {
            const selectedBreedId = document.getElementById('breed-select').value;

            if (selectedBreedId) {
                // Save the selected breed ID to local storage
                localStorage.setItem('selectedBreed', selectedBreedId);

                const breed = breeds.find(b => b.id === selectedBreedId);
                if (breed) {
                    document.getElementById('breed-name').textContent = `${breed.name} (${breed.origin})`;
                    document.getElementById('breed-description').textContent = breed.description;
                    document.getElementById('breed-link').href = breed.wikipedia_url;

                    // Fetch and display breed images
                    breedImages = await fetchBreedImages(breed.id);
                    currentImageIndex = 0; // Reset to the first image
                    document.getElementById('breed-image').src = breedImages[currentImageIndex];
                    document.getElementById('breed-details').classList.remove('hidden');

                    // Clear any existing interval
                    clearInterval(imageInterval);

                    // Set up image cycling
                    imageInterval = setInterval(() => {
                        currentImageIndex = (currentImageIndex + 1) % breedImages.length;
                        document.getElementById('breed-image').src = breedImages[currentImageIndex];
                    }, 3000); // Change image every 3 seconds
                }
            } else {
                // Clear local storage if no breed is selected
                localStorage.removeItem('selectedBreed');
                document.getElementById('breed-details').classList.add('hidden');

                // Clear the interval if no breed is selected
                clearInterval(imageInterval);
            }
        }

        // Initialize
        window.onload = fetchBreeds;
    </script>
</body>

</html>